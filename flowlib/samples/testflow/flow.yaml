flow_name: Demo Flow

# TODO: Allow Common Defaults for processors?
#   How would these be passed down and merged with child components?
# processor_defaults:
#   **nipyapi.nifi.models.processor_config_dto.ProcessorConfigDTO

# TODO: Allow Common Defaults for connections?
#   How would these be passed down and merged with child components?
# connection_defaults:
#   **nipyapi.nifi.models.connection_dto.ConnectionDTO

# TODO: How are required_vars and defaults passed down and merged with child components?

# TODO: Add top-level vars that can be used globally?

controllers:
- name: 'AWS Credential Controller - EAST'
  package_id: 'org.apache.nifi.processors.aws.credentials.provider.service.AWSCredentialsProviderControllerService'
  properties: {}
- name: 'AWS Credential Controller - WEST'
  package_id: 'org.apache.nifi.processors.aws.credentials.provider.service.AWSCredentialsProviderControllerService'
  properties: {}

canvas:
- name: listfetch-east
  element_type: ProcessGroup
  component_ref: common/s3_list_fetch.yaml
  # controller_refs:
  # - 'AWS Credential Controller - EAST'
  vars:
    s3_bucket: stackspace-us-east-1
    s3_region: us-east-1
    s3_prefix: /abc/def
  downstream:
  - name: debug
    relationships: ['success']

- name: listfetch-west
  element_type: ProcessGroup
  component_ref: common/s3_list_fetch.yaml
  # controller_refs:
  # - 'AWS Credential Controller - WEST'
  vars:
    s3_bucket: stackspace-us-west-1
    s3_region: us-west-1
  downstream:
  - name: debug
    relationships: ['success']

- name: debug
  element_type: ProcessGroup
  component_ref: common/debug.yaml
  downstream:
  - name: log-attribute
    relationships: ['success']

- name: log-attribute
  element_type: Processor
  config:
    package_id: org.apache.nifi.processors.standard.LogAttribute
    properties:
      Log Level: info
      Log Payload: False
