component_name: S3 List Fetch

defaults: # map(str, str)
  s3_min_object_age: 5m
  s3_key: "/"

required_vars: # list(str)
- s3_bucket
- s3_region

accepts_inputs: False # bool
accepts_outputs: True # bool

process_group: # list(FlowLibProcessor)
- name: list-s3
  element_type: Processor
  config:
    package_id: org.apache.nifi.processors.aws.s3.ListS3
    properties:
    # aws_credentials_provider_service:
      Bucket: $(s3_bucket)
      Region: $(s3_region)
      Minimum Object Age: $(s3_min_object_age)
      Prefix: $(s3_key)
  downstream:
  - name: debug
    relationships: ['success']

- name: debug
  element_type: ProcessGroup
  element_ref: ./common/debug.yaml
  downstream:
  - name: fetch-s3
    relationships: ['success']

- name: fetch-s3
  element_type: Processor
  config:
    package_id: org.apache.nifi.processors.aws.s3.FetchS3Object
    properties:
    # aws_credentials_provider_service:
      Bucket: $(s3_bucket)
      Region: $(s3_region)
  downstream:
  - name: output
    relationships: ['success']

- name: output
  element_type: OutputPort
