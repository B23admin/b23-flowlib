component_name: Process PDFs

defaults: {}
required_vars:
- destination_prefix

process_group:
- name: input
  type: input_port
  connections:
  - name: process-pdf

- name: process-pdf
  type: processor
  config:
    package_id: org.apache.nifi.processors.standard.AttributesToJSON
    auto_terminated_relationships: ['failure']
    properties:
      Destination: flowfile-content
  connections:
  - name: update-filename
    relationships: ['success']

- name: update-filename
  type: processor
  config:
    package_id: org.apache.nifi.processors.attributes.UpdateAttribute
    auto_terminated_relationships: ['failure']
    properties:
      destination: $(destination_prefix)/${filename:substringBeforeLast('.')}.json
  connections:
  - name: output
    relationships: ['success']

- name: output
  type: output_port
